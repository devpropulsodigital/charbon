<link rel="stylesheet" href="https://unpkg.com/swiper@8/swiper-bundle.min.css"/>

{%- liquid

  assign padding_horizontal = section.settings.padding_horizontal
  assign padding_horizontal_mobile = section.settings.padding_horizontal_mobile
  assign padding_top = section.settings.padding_top
  assign padding_bottom = section.settings.padding_bottom
  assign border_color = section.settings.border_color
  assign border_gradient = section.settings.border_gradient
  assign border_thickness = section.settings.border_thickness
  assign margin_top = section.settings.margin_top
  assign margin_bottom = section.settings.margin_bottom
  assign background_color = section.settings.background_color
  assign background_gradient = section.settings.background_gradient
  assign full_width = section.settings.full_width
  assign content_width = section.settings.content_width
  assign lazy = section.settings.lazy
   
  assign slider_view = section.settings.slider_view
  assign slider_view_mobile = section.settings.slider_view_mobile
  assign menu_gap = section.settings.menu_gap
  assign menu_gap_mobile = section.settings.menu_gap_mobile
  assign menu_width = section.settings.menu_width

  assign cercle_size_mobile = section.settings.cercle_size_mobile
  assign cercle_size = section.settings.cercle_size
  assign cercle_border_thickness = section.settings.cercle_border_thickness
  assign cercle_border_color = section.settings.cercle_border_color
  assign cercle_border_gradient = section.settings.cercle_border_gradient
  assign transform_square = section.settings.transform_square
  assign cercle_space_mobile = section.settings.cercle_space_mobile
  assign cercle_space = section.settings.cercle_space

  assign text_size = section.settings.text_size
  assign text_size_mobile = section.settings.text_size_mobile
  assign text_color = section.settings.text_color
  assign text_font = section.settings.text_font
  assign text_height = section.settings.text_height
  assign text_mt = section.settings.text_mt
  
-%}

{%- style -%}

  {{  text_font | font_face: font_display: 'swap' }}

  .circle-{{ section.id }} {
        display: block;
      } 
  
  .section-{{ section.id }} {
    border-top: solid {{ border_color }} {{ border_thickness }}px;
    border-bottom: solid {{ border_color }} {{ border_thickness }}px;
    margin-top: {{ margin_top | times: 0.75 | round: 0 }}px;
    margin-bottom: {{ margin_bottom | times: 0.75 | round: 0 }}px;
    overflow: hidden;
  }
  
  .section-{{ section.id }}-settings {
    margin: 0 auto;
    padding-top: {{ padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ padding_bottom | times: 0.75 | round: 0 }}px;
    padding-left: {{ padding_horizontal_mobile }}rem;
    padding-right: {{ padding_horizontal_mobile }}rem;
  }

  .circle-slider-wrapper-{{ section.id }} {
    margin: 0px auto;
    width: 100%;
    position: relative;
    overflow: hidden;
  }




  .circle-slider-wrapper-{{ section.id }}::before,
.circle-slider-wrapper-{{ section.id }}::after {
  content: '';
  position: absolute;
  top: 0;
  bottom: 0;
  width: 10px;
  z-index: 10;
  pointer-events: none;
}

.circle-slider-wrapper-{{ section.id }}::before {
  left: 0;
  background: linear-gradient(to right, rgba(255, 255, 255, 1), rgba(255, 255, 255, 0));
}

.circle-slider-wrapper-{{ section.id }}::after {
  right: 0;
  background: linear-gradient(to left, rgba(255, 255, 255, 1), rgba(255, 255, 255, 0));
}


  

  .circle-slider-{{ section.id }} {
    margin: 0px auto;
    width: 100% !important;
    max-width: fit-content !important;
    overflow:visible;
  }

  .circle-item-{{ section.id }} {
    width: 100%;
    max-width: {{ cercle_size_mobile }}px;
    box-sizing: border-box;
  }

  .circle-item-{{ section.id }},
  .swiper-slide,
  .swiper,
  .circle-icon-{{ section.id }} {
    box-sizing: border-box !important;
    transition: transform 0.3s ease-in-out;
  }
  
  .circle-item-{{ section.id }}:last-child {
    margin-right: 0!important;
  }

  .circle-icon-{{ section.id }} {
    margin: 0px auto;
    display: block;
    width: {{ cercle_size_mobile }}px;
    height: {{ cercle_size_mobile }}px;
    border: {{ cercle_border_thickness }}px solid {{ cercle_border_color }};
    overflow: hidden;
    transition: transform 0.3s ease-in-out;
  }

  .circle-icon-{{ section.id }}:hover {
    transform: scale(1.1);
  }

  .swiper, swiper-container {
    padding: 10px !important;
  }
  
  .circle-icon-{{ section.id }} img,
  .circle-icon-{{ section.id }} svg {
    display: block;
    width: 100%;
    height: 100%;
    object-fit: cover;
    border: {{ cercle_space_mobile }}px solid {{ background_color }};
  }

  .circle-icon-{{ section.id }} svg {
    background-color: #DADADA;
  }

  {% if section.settings.font_text_custom %}
    .circle-text-{{ section.id }} {
       font-family: {{ text_font.family }}, {{ text_font.fallback_families }};
       font-weight: {{ text_font.weight }};
       font-style: {{ text_font.style }};
    }
  {% endif %} 

  .circle-text-{{ section.id }} {
    margin: 0;
    margin-top: {{ text_mt | times: 0.75 | round: 0 }}px;
    font-size: {{ text_size_mobile }}px;
    color: {{ text_color }};
    line-height: {{ text_height }}%;
    text-transform: unset;
    word-wrap: break-word;
    text-align: center;
  }

  .circle-item-{{ section.id }} {
    box-sizing: border-box !important;
  }

  @media screen and (min-width: 1024px) {
    
    .section-{{ section.id }} {
      margin-top: {{ margin_top }}px;
      margin-bottom: {{ margin_bottom }}px;
    }
    
    .section-{{ section.id }}-settings {
      padding: 0 5rem;
      padding-top: {{ padding_top }}px;
      padding-bottom: {{ padding_bottom }}px;
      padding-left: {{ padding_horizontal }}rem;
      padding-right: {{ padding_horizontal }}rem;
    }

    .circle-item-{{ section.id }} {
      max-width: {{ cercle_size }}px;
    }

    .circle-icon-{{ section.id }} {
      width: {{ cercle_size }}px;
      height: {{ cercle_size }}px;
    }

    .circle-icon-{{ section.id }} img,
    .circle-icon-{{ section.id }} svg {
      border: {{ cercle_space }}px solid {{ background_color }};
    }

    .circle-text-{{ section.id }} {
      margin-top: {{ text_mt }}px;
      font-size: {{ text_size }}px;
    }

    .circle-slider-wrapper-{{ section.id }} {
      max-width: {{ menu_width }}%;
    }
    
  }

{%- endstyle -%}

{% unless full_width %}
  <style>
    .section-{{ section.id }}-settings {
      max-width: {{ content_width }}rem;
    }
  </style>
{% endunless %}

{% unless transform_square %}
  <style>
    .circle-icon-{{ section.id }},
    .circle-icon-{{ section.id }} img,
    .circle-icon-{{ section.id }} svg {
      border-radius: 50%;
    }

    .circle-icon-{{ section.id }} img,
    .circle-icon-{{ section.id }} svg {
      border-radius: 50%;
    }
    
  </style>
{% endunless %}

{% if border_gradient != blank %}
  <style>
    .section-{{ section.id }} {
      border-image: {{ border_gradient }};
      border-image-slice: 1;
    }
  </style>
{% endif %}

{% if cercle_border_gradient != blank %}
  <style>
    .circle-icon-{{ section.id }} {
      background-image: {{ cercle_border_gradient }};
      border: 0px;
      padding: {{ cercle_border_thickness }}px;
    }
  </style>
{% endif %}

<style>
  .circle-slider-{{ section.id }}.preview .swiper-wrapper {
    display: flex;
    align-items: top;
    justify-content: space-between;
    overflow: hidden;
  }

  .circle-slider-{{ section.id }}.preview .circle-item-{{ section.id }} {
    width: 40%;
  }

  .circle-slider-{{ section.id }}.preview .circle-item-{{ section.id }}:not(:first-child) {
    margin-left: {{ menu_gap_mobile }}px;
  } 

  @media(min-width: 1024px) {
    .circle-slider-{{ section.id }}.preview .circle-item-{{ section.id }}:not(:first-child) {
      margin-left: {{ menu_gap }}px;
    } 

  .circle-slider-{{ section.id }} {
    overflow:hidden;
  }

    .circle-slider-{{ section.id }}.preview .circle-item-{{ section.id }} {
      width: 15%;
    }
  }
</style>

<div class="section-{{ section.id }} circle-{{ section.id }}  content-for-grouping {% if section.settings.mobile-hidden %} mobile-hidden {% endif %} {% if section.settings.tablet-hidden %} tablet-hidden {% endif %} {% if section.settings.laptop-hidden %} laptop-hidden {% endif %} {% if section.settings.desktop-hidden %} desktop-hidden {% endif %}" style="background-color:{{ background_color }}; background-image: {{ background_gradient }};">
  {% if section.settings.display_id %}
    <copy-button class='section-id-btn button' data-content="#shopify-section-{{ section.id }}" data-success="false">
      <span class="copy-text">Cliquez pour copier l'ID de la section</span>
      <span class="copy-success">ID de la section copié !</span>
    </copy-button>
  {% endif %}
  <div class="section-{{ section.id }}-settings">
    <div class="circle-slider-wrapper-{{ section.id }}">
      <div class="swiper circle-slider-{{ section.id }} preview">
        <div class="swiper-wrapper">
    		{%- for block in section.blocks -%}
              <div class="circle-item-{{ section.id }} swiper-slide">
                
                <{% if block.settings.cercle_link != blank %}a href="{{ block.settings.cercle_link }}"{% else %}div{% endif %} class="circle-icon-{{ section.id }}">
                  
                  {%- if block.settings.cercle_img -%}
                    <img src="{{ block.settings.cercle_img | image_url }}" alt="{{ block.settings.cercle_img.alt }}" {% if lazy %}loading="lazy"{% endif %}>
                  {%- else -%}
                    {{ 'image' | placeholder_svg_tag }}
                  {%- endif -%}
              
    			</{% if block.settings.cercle_link != blank %}a{% else %}div{% endif %}>
              
                {% if block.settings.cercle_text != blank %}
                  <p class="circle-text-{{ section.id }}"> {{ block.settings.cercle_text }} </p>
                {% endif %}
              
              </div>
          	{%- endfor -%}
        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://unpkg.com/swiper@8/swiper-bundle.min.js"></script>

<script>
  function initInstagramMenu() {
   document.querySelector('.circle-slider-{{ section.id }}').classList.remove('preview');
    new Swiper('.circle-slider-{{ section.id }}', {
        speed: 300,
        slidesPerView: "auto",
        breakpoints: {
          320: {
            spaceBetween: {{ menu_gap_mobile }}
          },
          768: {
            spaceBetween: {{ menu_gap_mobile }}
          },
          1024: {
            spaceBetween: {{ menu_gap }}
          }
        },
    }); 
  }

  document.addEventListener('DOMContentLoaded', initInstagramMenu);
  
  if (Shopify.designMode) {
     document.addEventListener('shopify:section:unload', initInstagramMenu);
     document.addEventListener('shopify:section:load', initInstagramMenu);
  }
</script>

{% schema %}
  {
    "name": "Menu Story",
	"class": "section",
	"tag": "section",
    "settings": [
          {
      "type": "header",
      "content": "ID de la section"
      },
      {
      "type": "checkbox",
      "id": "display_id",
      "label": "Afficher le bouton pour copier l'ID de la section",
      "info": "L'ID peut être utilisé dans la section 'Double section' pour afficher 2 sections sur la même ligne ou dans la section 'onglets' pour afficher la section dans des onglets. L'ID peut également être utilisé dans un lien de bouton pour faire défiler la page jusqu'à cette section.",
      "default": false
      },
      {
      "type": "header",
      "content": "Masquer la section selon le type d'appareil"
      },
      {
        "type": "checkbox",
        "id": "mobile-hidden",
        "label": "Masquer sur mobile",
        "default": false
      },
      {
        "type": "checkbox",
        "id": "tablet-hidden",
        "label": "Masquer sur tablette",
        "default": false
      },
      {
        "type": "checkbox",
        "id": "laptop-hidden",
        "label": "Masquer sur ordinateur portable",
        "default": false
      },
      {
        "type": "checkbox",
        "id": "desktop-hidden",
        "label": "Masquer sur ordinateur",
        "default": false
      },
        {
          "type": "header",
          "content": "Menu"
        },
        {
          "type": "range",
          "id": "menu_width",
          "min": 0,
          "max": 100,
          "step": 2,
          "unit": "%",
          "label": "Largeur du menu",
          "default": 100
        },
        {
          "type": "range",
          "id": "menu_gap",
          "min": 0,
          "max": 100,
          "step": 2,
          "unit": "px",
          "label": "Espèce entre les cercles",
          "default": 16
        },
        {
          "type": "range",
          "id": "menu_gap_mobile",
          "min": 0,
          "max": 100,
          "step": 2,
          "unit": "px",
          "label": "Espèce entre les cercles sur mobile",
          "default": 16
        },
        {
          "type": "header",
          "content": "Cercles"
        },
        {
          "type": "range",
          "id": "cercle_size",
          "min": 20,
          "max": 200,
          "step": 2,
          "unit": "px",
          "label": "Taille des cercles",
          "default": 100
        },
        {
          "type": "range",
          "id": "cercle_size_mobile",
          "min": 20,
          "max": 200,
          "step": 2,
          "unit": "px",
          "label": "Taille des cercles sur mobile",
          "default": 80
        },
        {
          "type": "range",
          "id": "cercle_space",
          "min": 0,
          "max": 40,
          "step": 2,
          "unit": "px",
          "label": "Espace entre l'image et la bordure",
          "default": 4
        },
        {
          "type": "range",
          "id": "cercle_space_mobile",
          "min": 0,
          "max": 40,
          "step": 2,
          "unit": "px",
          "label": "Espace entre l'image et la bordure sur mobile",
          "default": 4
        },
        {
          "type": "range",
          "id": "cercle_border_thickness",
          "min": 0,
          "max": 10,
          "step": 1,
          "unit": "px",
          "label": "Épaisseur de la bordure du cercle",
          "default": 2
        },
        {
          "type": "color",
          "label": "Couleur de la bordure",
          "id": "cercle_border_color",
          "default": "#000000"
        },
        {
          "type": "color_background",
          "id": "cercle_border_gradient",
          "label": "Dégradé",
          "info":"Le dégradé remplace la couleur de la bordure. Supprimer pour afficher la couleur de la bordure"
        },
        {
          "type": "checkbox",
          "id": "transform_square",
          "default": false,
          "label": "Transformer les cercles en carrés"
        },
        {
          "type": "header",
          "content": "Texte"
        },
        {
            "type": "checkbox",
            "id": "font_text_custom",
            "label": "Appliquer une police différente du thème",
            "default": false
        },
        {
          "type": "font_picker",
          "id": "text_font",
          "label": "Police",
          "default": "poppins_n5"
        },
        {
          "type": "color",
          "label": "Couleur",
          "id": "Couleur",
          "default": "#000000"
        },
        {
          "type": "range",
          "id": "text_size",
          "min": 0,
          "max": 40,
          "step": 2,
          "unit": "px",
          "label": "Taille",
          "default": 12
        },
        {
          "type": "range",
          "id": "text_size_mobile",
          "min": 0,
          "max": 40,
          "step": 2,
          "unit": "px",
          "label": "Taille sur mobile",
          "default": 10
        },
        {
          "type": "range",
          "id": "text_height",
          "min": 50,
          "max": 200,
          "step": 10,
          "unit": "%",
          "label": "Interligne",
          "default": 100
        },
        {
          "type": "range",
          "id": "text_mt",
          "min": 0,
          "max": 100,
          "step": 2,
          "unit": "px",
          "label": "Marge supérieure",
          "default": 10
        },
        {
          "type": "header",
          "content": "Marge extérieure de la section"
        },
        {
          "type": "range",
          "id": "margin_top",
          "min": 0,
          "max": 100,
          "step": 4,
          "unit": "px",
          "label": "Marge supérieure",
          "default": 0
        },
        {
          "type": "range",
          "id": "margin_bottom",
          "min": 0,
          "max": 100,
          "step": 4,
          "unit": "px",
          "label": "Margin inférieure",
          "default": 0
        },
        {
          "type": "header",
          "content": "Marge intérieure de la section"
        },
        {
          "type": "range",
          "id": "padding_top",
          "min": 0,
          "max": 100,
          "step": 4,
          "unit": "px",
          "label": "Marge supérieure",
          "default": 36
        },
        {
           "type": "range",
           "id": "padding_bottom",
           "min": 0,
           "max": 100,
           "step": 4,
           "unit": "px",
           "label": "Marge inférieure",
           "default": 36
        },
        {
          "type": "range",
          "id": "padding_horizontal",
          "min": 0,
          "max": 30,
          "step": 1,
          "unit": "rem",
          "label": "Marge latérale",
          "default": 5
        },
        {
          "type": "range",
          "id": "padding_horizontal_mobile",
          "min": 0,
          "max": 15,
          "step": 0.5,
          "unit": "rem",
          "label": "Marge latérale sur mobile",
          "default": 0
        },
        {
          "type": "header",
          "content": "Section"
        },
	    {
          "type": "color",
          "label": "Couleur du fond",
          "id": "background_color",
          "default": "#FFFFFF"
        },
        {
          "type": "color_background",
          "id": "background_gradient",
          "label": "Dégradé du fond"
        },
        {
          "type": "range",
          "id": "border_thickness",
          "min": 0,
          "max": 50,
          "step": 1,
          "unit": "px",
          "label": "Épaisseur de la bordure",
          "default": 0
        },
        {
          "type": "color",
          "label": "Couleur de la bordure",
          "id": "border_color",
          "default": "#000000"
        },
        {
          "type": "color_background",
          "id": "border_gradient",
          "label": "Dégradé de la bordure"
        },
        {
          "type": "checkbox",
          "id": "full_width",
          "label": "Pleine largeur",
          "default": true
        },
        {
          "type": "range",
          "id": "content_width",
          "min": 0,
          "max": 400,
          "step": 10,
          "unit": "rem",
          "label": "Largeur de la section",
          "default": 150
        },
        {
          "type": "checkbox",
          "id": "lazy",
          "label": "Chargement différé",
          "info": "Lazyload",
          "default": true
        }
	],
	 "blocks": [
        {
          "type": "Image",
          "name": "Cercle",
          "settings": [
            {
              "type": "image_picker",
              "id": "cercle_img",
              "label": "Image"
            },
			{
              "type": "text",
              "id": "cercle_text",
              "label": "Texte",
			  "default":"Collection"
            },
			{
              "type": "url",
              "id": "cercle_link",
              "label": "Link"
            }
          ]
        }
    ],
 	"presets": [
      {
        "name": "Menu Story",
		"blocks": [
        {
          "type": "Image"
        },
        {
          "type": "Image"
        },
        {
          "type": "Image"
        },
		{
          "type": "Image"
        },
		{
          "type": "Image"
        }
        ]
      }
	]
  }
{% endschema %}